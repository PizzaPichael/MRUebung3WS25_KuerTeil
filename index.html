<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kuer Abgabe WiSe 25/26</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <style>
      #debug-ui {
        position: fixed;
        top: 10px;
        left: 800px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        z-index: 9999;
      }
      #debug-ui button {
        background: #4caf50;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 3px;
        cursor: pointer;
        margin-right: 10px;
      }
      #debug-ui button:hover {
        background: #45a049;
      }
      #debug-ui label {
        cursor: pointer;
        user-select: none;
      }
      #debug-ui input[type='checkbox'] {
        cursor: pointer;
        margin-left: 5px;
      }
    </style>

    <!--Custom scripts-->
    <script src="/src/components/custom/teleport-component.js"></script>
    <script src="/src/components/custom/look-at-camera-component.js"></script>
    <script src="/src/components/custom/proximity-detection-by-circle-componente.js"></script>
    <script src="/src/components/custom/camera-position-debug.js"></script>
    <script src="/src/components/custom/camera-persistence.js"></script>
    <script src="/src/components/custom/blink-cursor.js"></script>
    <script src="/src/components/custom/paper-glide-upwards.js"></script>

    <!--External scripts-->
    <script src="/src/components/external/aframe-keyboard.min.js"></script>
  </head>
  <body>
    <!-- Debug UI -->
    <div id="debug-ui">
      <button id="logCameraBtn">Log Camera Position</button>
      <label>
        <input type="checkbox" id="persistCheckbox" />
        Persist Camera on Reload
      </label>
    </div>

    <script>
      // Button Event Listener
      document
        .getElementById('logCameraBtn')
        .addEventListener('click', function () {
          const camera = document.querySelector('#head');
          if (camera && camera.components['camera-position-debug']) {
            camera.components['camera-position-debug'].logCurrentState();
          }
        });

      // Checkbox Event Listener
      document
        .getElementById('persistCheckbox')
        .addEventListener('change', function (e) {
          const camera = document.querySelector('#head');
          if (camera && camera.components['camera-persistence']) {
            camera.setAttribute(
              'camera-persistence',
              'enabled',
              e.target.checked
            );
          }
        });
    </script>

    <!--Scene-->
    <a-scene light="defaultLightsEnabled: true" stats>
      <!--Asset registration-->
      <a-assets>
        <!--Asset items-->
        <a-asset-item
          id="throneroom"
          src="/src/models/throneroom/throneroom_project.glb"
        ></a-asset-item>
        <a-asset-item
          id="stairs"
          src="/src/models/broken_stairs__concrete__high_poly/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="altar"
          src="/src/models/altar/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="lowpoly-altar"
          src="/src/models/altar_lowpoly_concept/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="old-paper"
          src="/src/models/old_paper/scene.gltf"
        ></a-asset-item>
        <a-assets-item
          id="computer"
          src="/src/models/old_retro_stylized_computer/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="curtain-rod"
          src="/src/models/curtain_rod/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="white-curtain"
          src="/src/models/curtain_774/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="victorian-curtain"
          src="/src/models/victorian_curtain/scene.gltf"
        ></a-assets-item>

        <!--Textures-->
        <img
          id="computerBaseTexture"
          src="/src/models/old_retro_stylized_computer/textures/Scene_-_Root_baseColor.png"
        />
        <img id="chatgptscreenshot" src="/src/textures/chatjibbedy-logo.png" />
        <img
          id="chatgptuielements"
          src="/src/textures/chat_gpt_text_input_element_with_greeting.png"
        />
        <img
          id="chatgptuielementswithcursor"
          src="/src/textures/chat_gpt_text_input_element_with_greeting_and_linecursor.png"
        />
      </a-assets>

      <!--Entities-->
      <!--Camera Rig and Controller-->
      <a-entity id="cameraRig">
        <a-entity
          id="head"
          camera="active: true"
          look-controls
          wasd-controls="fly: false"
          position="0 1.7 -6"
          rotation="0 0 0"
          camera-position-debug
          camera-persistence
        >
          <a-entity
            id="keyboard"
            position="-0.2 -0.15 -0.5"
            a-keyboard
            visible="false"
          ></a-entity>
          <!-- Mouse input -->
          <a-entity
            id="mouseCursor"
            raycaster="objects: .collidable"
            cursor="rayOrigin: mouse"
          ></a-entity>
        </a-entity>
        <!--starting player pos = "0 1.7 -6"-->
        <a-entity
          id="left-hand"
          oculus-touch-controls="hand: left"
          simple-teleport="cameraRig: #cameraRig"
        ></a-entity>
        <a-entity
          id="right-hand"
          oculus-touch-controls="hand: right"
        ></a-entity>
      </a-entity>

      <!--Teleportation planes-->
      <a-plane
        id="teleport-ground"
        position="0 0 0"
        rotation="-90 0 0"
        width="50"
        height="50"
        material="opacity: 0; transparent: true"
        visible="false"
      ></a-plane>

      <!--Throneroom object-->
      <a-entity
        id="throneroomentity"
        gltf-model="#throneroom"
        position="0 0 0"
        scale="4 4 4"
        shadow="receive: false"
      ></a-entity>

      <!--Throneroom interior-->
      <!--Altar Area-->
      <!--
      <a-entity>
        <a-entity
          id="stairsentitiy"
          gltf-model="#stairs"
          position="0 -1.2 -40"
          scale="0.6 0.6 0.6"
          rotation="0 90 0"
        >
        </a-entity>
        <a-entity
          id="altar-entitiy"
          gltf-model="#altar"
          position="0 6 -50"
          scale="0.03 0.03 0.03"
          rotation="0 0 0"
        >
        </a-entity>
      </a-entity>
      -->

      <!--Interaktionsterminal-->
      <a-entity>
        <a-entity
          id="lowpoly-altar-entitiy"
          gltf-model="#lowpoly-altar"
          position="0 0 -30"
          scale="1 1 1"
          rotation="0 0 0"
        >
        </a-entity>
        <a-entity
          id="old-paper-entitiy"
          gltf-model="#old-paper"
          position="0 1.347 -30"
          rotation="0 90 23.807"
          scale="0.312 0.5 0.309"
          glide-upwards="enabled: false, speed: 0.01"
          proximity-circle="
            target: #paper-proximity-plane; 
            componentToChange: glide-upwards;
            compAttrToChange: enabled;
            compAttrNewBoolValue: true"
        >
          <a-text
            value="Wie kann ich dir heute helfen, die Welt zu verbessern?"
            position="0.08 0.11 -0.97"
            rotation="-90 -90 0"
            width="2"
            wrap-count="46"
            color="black"
          >
          </a-text>
          <a-plane
            src="#chatgptuielements"
            position="0 0.1 0"
            rotation="-90 -90 0"
            height="0.63"
            width="2.92"
            material="transparent: true; alphaTest: 0.5"
            blink-cursor="non_cursor_src: #chatgptuielements; cursor_src: #chatgptuielementswithcursor"
          >
          </a-plane>
        </a-entity>
        <a-circle
          id="paper-proximity-plane"
          position="0 0.03 -30"
          rotation="-90 0 0"
          radius="5"
          color="black"
          transparent="true"
          opacity="0"
        ></a-circle>
      </a-entity>

      <!--Altar curtains-->
      <!--
      <a-entity>
        <a-entity
          id="white-curtain-entity"
          gltf-model="#white-curtain"
          position="1 0 -59"
          rotation="0 0 0"
          scale="0.15 0.3 0.2"
        >
        </a-entity>
        <a-entity
          id="victorian-curtain-entity"
          gltf-model="#victorian-curtain"
          position="9 16 -57"
          rotation="0 0 0"
          scale="4 8 10"
        >
        </a-entity>
        <a-entity
          id="victorian-curtain-entity-two"
          gltf-model="#victorian-curtain"
          position="-9 16 -57"
          rotation="0 -180 0"
          scale="4 8 10"
        >
        </a-entity>
      </a-entity>
      -->
      <!--Computer-->
      <a-entity
        id="computer-entitiy"
        gltf-model="#computer"
        position="0 15 -50"
        scale="1 1 1"
        rotation="0 0 0"
        look-at-camera="enabled: false"
        animation="property: position; to: 0 15.5 -50; loop: true; dir: alternate; dur: 2000; easing: easeInOutQuad"
        proximity-circle="
          target: #computer-proximity-plane; 
          componentToChange: look-at-camera;
          compAttrToChange: enabled;
          compAttrNewBoolValue: true"
      >
        <a-plane
          position="0 4.5 2.23"
          height="3"
          width="4.8"
          color="black"
        ></a-plane>
        <a-plane
          src="#chatgptscreenshot"
          position="0 4.5 2.27"
          height="2.5"
          width="2.5"
          material="transparent: true; alphaTest: 0.5"
          animation="property: rotation; to: 0 0 -360; loop: true; dur: 5000; easing: easeInOutCubic"
        >
        </a-plane>
      </a-entity>
      <a-circle
        id="computer-proximity-plane"
        position="0 0.03 -25"
        rotation="-90 0 0"
        radius="40"
        color="black"
        transparent="true"
        opacity="0"
      ></a-circle>

      <!--Curtains area-->
      <a-entity
        id="curtain-rod-entity"
        gltf-model="#curtain-rod"
        position="-26.171 34 -51.699"
        rotation="0 -49.65 0"
        scale="0.2 0.2 1"
      >
      </a-entity>
      <a-entity
        id="curtain-rod-entity-two"
        gltf-model="#curtain-rod"
        position="26.171 34 -51.699"
        rotation="0 49.65 0"
        scale="0.2 0.2 1"
      >
      </a-entity>
    </a-scene>
  </body>
</html>
