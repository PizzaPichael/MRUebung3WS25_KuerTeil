<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kuer Abgabe WiSe 25/26</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/MozillaReality/ammo.js@8bbc0ea/builds/ammo.wasm.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.4/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>

    <!--The debug UI has been added by copilot-->
    <style>
      #debug-ui {
        position: fixed;
        top: 10px;
        left: 800px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        z-index: 9999;
      }
      #debug-ui button {
        background: #4caf50;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 3px;
        cursor: pointer;
        margin-right: 10px;
      }
      #debug-ui button:hover {
        background: #45a049;
      }
      #debug-ui label {
        cursor: pointer;
        user-select: none;
      }
      #debug-ui input[type='checkbox'] {
        cursor: pointer;
        margin-left: 5px;
      }
    </style>

    <!--Scripts-->
    <div>
      <!--Custom scripts-->
      <script src="/src/components/custom/teleport-component.js"></script>
      <script src="/src/components/custom/look-at-camera-component.js"></script>
      <script src="/src/components/custom/proximity-detection-by-circle-componente.js"></script>
      <script src="/src/components/custom/camera-position-debug.js"></script>
      <script src="/src/components/custom/camera-persistence.js"></script>
      <script src="/src/components/custom/blink-cursor.js"></script>
      <script src="/src/components/custom/paper-glide-upwards.js"></script>
      <script src="/src/components/custom/spiral-movement.js"></script>
      <script src="/src/components/custom/spawn-text-planes.js"></script>
      <script src="/src/components/custom/hand-grab.js"></script>
      <script src="/src/components/custom/grabbable-custom.js"></script>
      <script src="/src/components/custom/on-event-teleport.js"></script>
      <script src="/src/components/custom/on-event-deactivate-components.js"></script>
      <script src="/src/components/custom/torchlight-spawner.js"></script>
      <script src="/src/components/custom/chat-interaction.js"></script>
      <script src="/src/components/custom/ar-entites-component.js"></script>
      <script src="/src/components/custom/vr-entities-component.js"></script>
       <!--External scripts-->
      <script src="/src/components/external/aframe-keyboard.min.js"></script>
    </div>
  </head>
  <body>
    
    <!-- Debug UI, written by Copilot -->
    <div id="debug-ui">
      <button id="logCameraBtn">Log Camera Position</button>
      <label>
        <input type="checkbox" id="persistCheckbox" />
        Persist Camera on Reload
      </label>
    </div>

    <script>
      // Button Event Listener, written by Copilot
      document
        .getElementById('logCameraBtn')
        .addEventListener('click', function () {
          const camera = document.querySelector('#head');
          if (camera && camera.components['camera-position-debug']) {
            camera.components['camera-position-debug'].logCurrentState();
          }
        });

      // Checkbox Event Listener, written by Copilot
      document
        .getElementById('persistCheckbox')
        .addEventListener('change', function (e) {
          const camera = document.querySelector('#head');
          if (camera && camera.components['camera-persistence']) {
            camera.setAttribute(
              'camera-persistence',
              'enabled',
              e.target.checked,
            );
          }
        });
    </script>

    <!--Scene-->
    <a-scene id="scene"
      light="defaultLightsEnabled: true"
      stats
      physics=" driver: ammo; debug: false; debugDrawMode: 1;"
      xr-mode-ui="enabled: true; enterVREnabled: true; enterAREnabled: true; XRMode: xr;"
    >
      <!--Asset registration-->
      <a-assets id="asset-registration">
        <!--Asset items-->
        <a-asset-item
          id="throneroom"
          src="/src/models/throneroom/throneroom_project.glb"
        ></a-asset-item>
        <a-asset-item
          id="stairs"
          src="/src/models/broken_stairs__concrete__high_poly/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="altar"
          src="/src/models/altar/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="lowpoly-altar"
          src="/src/models/altar_lowpoly_concept/scene.gltf"
        ></a-asset-item>
        <a-asset-item
          id="old-paper"
          src="/src/models/old_paper/scene.gltf"
        ></a-asset-item>
        <a-assets-item
          id="computer"
          src="/src/models/old_retro_stylized_computer/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="curtain-rod"
          src="/src/models/curtain_rod/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="white-curtain"
          src="/src/models/curtain_774/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="victorian-curtain"
          src="/src/models/victorian_curtain/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="generator"
          src="/src/models/o2_generator/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="fence"
          src="/src/models/big_fence/scene_multiple.gltf"
        ></a-assets-item>
        <a-assets-item
          id="socket"
          src="/src/models/europe_wall_socket/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="diesel-generator"
          src="/src/models/diesel_generator_low-poly_game_asset/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="plug"
          src="/src/models/power_plug_european/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="antenna"
          src="/src/models/usb_wifi_adapter__antenna/scene.gltf"
        ></a-assets-item>
        <a-assets-item
          id="antenna-plug"
          src="/src/models/antenna_plug/untitled.gltf"
        ></a-assets-item>

        <!--Textures-->
        <img
          id="computerBaseTexture"
          src="/src/models/old_retro_stylized_computer/textures/Scene_-_Root_baseColor.png"
        />
        <img id="chatgptscreenshot" src="/src/textures/chatjibbedy-logo.png" />
        <img
          id="chatgptuielements"
          src="/src/textures/chat_gpt_text_input_element_with_greeting.png"
        />
        <img
          id="chatgptuielementswithcursor"
          src="/src/textures/chat_gpt_text_input_element_with_greeting_and_linecursor.png"
        />
        <img
          id="chessfloor-diff"
          src="/src/textures/floor_tiles_06_1k/textures/floor_tiles_06_diff_1k.jpg"
        />
        <img
          id="chessfloor-disp"
          src="/src/textures/floor_tiles_06_1k/textures/floor_tiles_06_disp_1k.jpg"
        />
        <img
          id="chessfloor-rough"
          src="/src/textures/floor_tiles_06_1k/textures/floor_tiles_06_rough_1k.jpg"
        />
      </a-assets>

      <!--Entities-->
      <!--Camera Rig and Controller-->
      <a-entity id="cameraRig">
        <a-entity
          id="head"
          camera="active: true"
          look-controls
          wasd-controls="fly: false"
          position="0 1.7 -6"
          rotation="0 0 0"
          camera-position-debug
          camera-persistence
        >
          <a-entity
            id="keyboard"
            position="-0.2 -0.15 -0.5"
            a-keyboard
            visible="false"
          ></a-entity>
          <!-- Mouse input -->
          <a-entity
            id="mouseCursor"
            raycaster="objects: .collidable"
            cursor="rayOrigin: mouse"
          ></a-entity>
        </a-entity>
        <!--starting player pos = "0 1.7 -6"-->
        <a-entity
          id="left-hand"
          meta-touch-controls="hand: left"
          simple-teleport="cameraRig: #cameraRig"
          hand-grab
        ></a-entity>
        <a-entity
          id="right-hand"
          meta-touch-controls="hand: right"
          hand-grab
          raycaster="objects: .clickable; far: 5"
          laser-controls="hand: right"
          cursor="rayOrigin: entity; fuse: false"
        ></a-entity>
      </a-entity>

      <!--Teleportation planes-->
      <a-plane id="teleport-ground"
        position="0 0 0"
        rotation="-90 0 0"
        width="50"
        height="50"
        material="opacity: 0; transparent: true"
        visible="false"
        ammo-body="type: static"
        ammo-shape="type: box"
      ></a-plane>

      <!--Throneroom collision box-->
      <a-box id="throneroom-floor-collision"
        position="0 0.01 -25"
        width="160"
        height="0.001"
        depth="240"
        visible="false"
        ammo-body="type: static"
        ammo-shape="type: box"
      ></a-box>

      <!--VR Entities - spawned by vr-entities-spawner component-->
      <!--Set enabled: false to disable VR entities-->
      <a-entity id="vr-entities"
        vr-entities-spawner="enabled: false"
        hide-on-enter-ar
      ></a-entity>

      <!--AR Entities - spawned by ar-entities-spawner component-->
      <!--Set enabled: false to disable AR entities-->
      <a-entity id="ar-entities"
        ar-entities-spawner="enabled: true"
        hide-on-enter-vr
      ></a-entity>
    </a-scene>
  </body>
</html>
